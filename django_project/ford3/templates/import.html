{% csrf_token %}
<script type='text/javascript'>

  const getCSRFToken = () => {
    return document.querySelector('input[name="csrfmiddlewaretoken"]').value
  }

  const processQualification = (providerId, data) => {
    url = '/providers/' + providerId + '/qualifications/import/'
    const request = new XMLHttpRequest()
    request.open('POST', url, true)
    request.setRequestHeader('Content-Type', 'application/json')
    request.setRequestHeader('X-CSRFToken', getCSRFToken());

    request.onload = function () {
      if (request.status >= 200 && request.status < 400) {
        const data = JSON.parse(request.responseText)
      }
    }
    request.send(JSON.stringify(data))
  }

  const main = () => {
    const data = JSON.parse('{{ data|safe }}')
    const providerId = '{{ provider.id|safe }}'

    data.forEach((row) => {
      processQualification(providerId, row)
    })

  }

  main()
</script>